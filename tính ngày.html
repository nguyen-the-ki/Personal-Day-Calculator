<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tính Ngày – Tháng – Năm</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
  body, html {
    overflow-x: hidden; /* Giúp ngăn chặn lỗi tràn màn hình ngang */
    font-family: ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
    background: #ffffff;
    margin: 0;
    padding: 0;
    color: #000000;
  }

  h2 {
    text-align: center;
    margin-bottom: 40px;
    color: #000000;
    font-size: clamp(10px, 8vw, 36px);
  }

  label {
    display: block;
    font-size: clamp(10px, 4vw, 16px);
    margin-top: 18px;
    font-weight: 400;
    color: #000000;
  }

  .full {
    width: 100%;
    box-sizing: border-box;
  }

  /* LOẠI BỎ width và height CỐ ĐỊNH ở đây, để Tailwind xử lý */
  input[type="date"] {
    /* width: min(100%, 600px); <-- Bỏ dòng này */
    /* height: 48px; <-- Bỏ dòng này */
    padding: 6px 10px;
    margin-top: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: clamp(12px, 4vw, 16px);
    color: #000000;
    background-color: #ffffff;
    font-family: ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
    box-sizing: border-box;
  }

  input[type="date"]:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  .result-box {
    text-align: center;
    background: transparent;
    padding: 0;
    border-radius: 0;
    font-size: clamp(10px, 5vw, 24px);
    line-height: 1.7;
    margin-top: 36px;
    border: none;
  }

  .item {
    font-weight: 700;
    margin-top: 8px;
    color: #000000;
  }

  .number {
    color: #ff0000;
  }
  
  #birth, #target {
      line-height: 44px; 
      text-align: left;
  }

  #birth::-webkit-date-and-time-value,
  #target::-webkit-date-and-time-value {
      text-align: left !important;
      padding-left: 0px; 
  }
</style>
</head>
<body>

<div class="max-w-md mx-auto mt-10 p-7 bg-white rounded-xl">
  <h2 class="text-center text-3xl font-bold mb-12">Năng lượng cá nhân</h2>

  <label class="flex items-center gap-2 text-sm font-medium text-gray-700 mb-2">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
      <circle cx="12" cy="7" r="4"></circle>
    </svg>
    Ngày sinh:
  </label>
  <input type="date" id="birth" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-gray-50 text-[17px]">


  <label class="flex items-center gap-2 text-sm font-medium text-gray-700 mb-2">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M8 2v4"></path>
      <path d="M16 2v4"></path>
      <rect width="18" height="18" x="3" y="4" rx="2"></rect>
      <path d="M3 10h18"></path>
    </svg>
    Ngày cần tính:
  </label>
  <input type="date" id="target" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-gray-50 text-[17px]">


  <div id="output" class="w-full"></div>
</div>

<script>
function sumToOneDigit(num) {
  num = num.toString().replace(/\D/g, "");
  while (num.length > 1) {
    num = num.split("").reduce((a,b) => a + Number(b), 0).toString();
  }
  return Number(num);
}

function setTodayAsDefault() {
  let today = new Date();
  let yyyy = today.getFullYear();
  let mm = String(today.getMonth() + 1).padStart(2, "0");
  let dd = String(today.getDate()).padStart(2, "0");
  document.getElementById("target").value = `${yyyy}-${mm}-${dd}`;
}

function calculate() {
  let birth = document.getElementById("birth").value;
  let target = document.getElementById("target").value;

  if (!birth) {
    document.getElementById("output").innerHTML = "";
    return;
  }

  if (!target) {
    let today = new Date();
    let yyyy = today.getFullYear();
    let mm = String(today.getMonth() + 1).padStart(2, "0");
    let dd = String(today.getDate()).padStart(2, "0");
    target = `${yyyy}-${mm}-${dd}`;
  }

  let [y1, m1, d1] = birth.split("-");
  let [y2, m2, d2] = target.split("-");

  let monthNumber = Number(m2);

  let a1 = Number(d1[0]), b1 = Number(d1[1]);
  let c1 = Number(m1[0]), d1_2 = Number(m1[1]);

  let a2 = Number(d2[0]), b2 = Number(d2[1]);
  let c2 = Number(m2[0]), d2_2 = Number(m2[1]);

  let yearDigits = y2.split("").map(Number);

  let N1 = sumToOneDigit(a1 + b1);
  let T1 = sumToOneDigit(c1 + d1_2);
  let N2 = sumToOneDigit(a2 + b2);
  let T2 = sumToOneDigit(c2 + d2_2);
  let Y  = sumToOneDigit(yearDigits.reduce((a,b)=>a+b,0));

  let YKQ = sumToOneDigit(N1 + T1 + Y);
  let TKQ = sumToOneDigit(YKQ + T2);
  let NKQ = sumToOneDigit(TKQ + N2);

  let displayYKQ = [YKQ], displayTKQ = [TKQ], displayNKQ = [NKQ];
  if (monthNumber >= 10 && monthNumber <= 12) {
    displayYKQ.push(sumToOneDigit(YKQ + 1));
    displayTKQ.push(sumToOneDigit(TKQ + 1));
    displayNKQ.push(sumToOneDigit(NKQ + 1));
  }

  document.getElementById("output").innerHTML = `
    <div class="result-box">
      <div class="item">Năm: <span class="number">${displayYKQ.join(" / ")}</span></div>
      <div class="item">Tháng: <span class="number">${displayTKQ.join(" / ")}</span></div>
      <div class="item">Ngày: <span class="number">${displayNKQ.join(" / ")}</span></div>
    </div>
  `;
}

document.getElementById('birth').addEventListener('input', calculate);
document.getElementById('target').addEventListener('input', calculate);
document.addEventListener('DOMContentLoaded', function() {
  setTodayAsDefault();
  calculate();
});
</script>

</body>
</html>
